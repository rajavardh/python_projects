from datetime import datetime

class BankAccount:
    def __init__(self, account_number, holder_name, balance=0):
        self.account_number = account_number
        self.holder_name = holder_name
        self.balance = balance
        self.transaction_history = []  
        self.add_transaction("Account Created", balance)

    def add_transaction(self, note, amount):
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        self.transaction_history.append({
            "type": note,
            "amount": amount,
            "timestamp": timestamp
        })

    def deposit(self, amount):
        if amount > 0:
            self.balance += amount
            self.add_transaction("Deposit", amount)
            print(f"Deposited ${amount}. New balance: ${self.balance}")
        else:
            print("Deposit amount must be positive.")

    def withdraw(self, amount):
        if 0 < amount <= self.balance:
            self.balance -= amount
            self.add_transaction("Withdrawal", amount)
            print(f"Withdrew ${amount}. Remaining balance: ${self.balance}")
        else:
            print("Insufficient funds or invalid amount.")

    def get_balance(self):
        return self.balance

    def transfer(self, amount, target_account):
        if 0 < amount <= self.balance:
            self.withdraw(amount)
            target_account.deposit(amount)
            self.add_transaction(f"Transfer to {target_account.holder_name}", amount)
            print(f"Transferred ${amount} to {target_account.holder_name}")
        else:
            print("Transfer failed: Check balance or amount.")

    def __str__(self):
        return f"Account: {self.account_number} | Holder: {self.holder_name} | Balance: ${self.balance}"


acc1 = BankAccount("101", "Alice", 500)
acc2 = BankAccount("102", "Bob", 200)

acc1.transfer(150, acc2)
acc2.deposit(200)
print(acc1)
print(acc2)

# Optional: print transaction history
print("\nAlice's Transactions:")
for t in acc1.transaction_history:
    print(t)

print("\nBob's Transactions:")
for t in acc2.transaction_history:
    print(t)
